resource "yandex_vpc_network" "net-1" {
  name = "${local.preffix}network"
  description = "My test network"
}

resource "yandex_vpc_subnet" "subnet" {
  count = 3
  v4_cidr_blocks = [var.subnets_addr[count.inde]]
  zone           = "${var.zone_list}"
  network_id     = yandex_vpc_network.net-1.id
  labels = {
    "project" = "slurm"
    "env" = "lab"
  }
  name = "${local.preffix}subnet-${count.index}"
}

resource "yandex_vpc_subnet" "subnet-2" {
  v4_cidr_blocks = ["10.2.0.0/16"]
  zone           = "ru-central1-b"
  network_id     = yandex_vpc_network.net-1.id
  labels = {
    "project" = "slurm"
    "env" = "lab"
  }
}

resource "yandex_vpc_subnet" "subnet-3" {
  v4_cidr_blocks = ["10.3.0.0/16"]
  zone           = "ru-central1-d"
  network_id     = yandex_vpc_network.net-1.id
  labels = {
    "project" = "slurm"
    "env" = "lab"
  }
}
